---
title: נקודות קיצון
---


<h1 style="text-align: center">נקודות קיצון</h1>


<br>
<h2>הקדמה</h2>

אתחיל בכמה הסתייגויות: אם הפוסטים האחרים שלי היו יחסית צמודים לאלו
של "לא מדויק", כאן כתבתי על החומר
ברמה פחות גבוהה/כללית/מקיפה. בחלק של מציאת נקודות קיצון לא כתבתי על
הדרך להבדיל בין נקודות קיצון לנקודות חשודות שאינן קיצון. בחלק של קיצון
תחת אילוצים הצטמצמתי למקרה הפרטי $$f:\mathbb{R}^{2}\rightarrow\mathbb{R}$$
כי עוד לא פיצחתי את המקרה הכללי. גם המקרה הפרטי היה לי קשה לעיכול,
ומקור אחד שממש עזר לי היה ערוץ היוטיוב של $$Dr.Trefor\,Bazzett$$.
זהו -- עכשיו לנושא:
&nbsp;  



בעיניי, פונקציות בכמה משתנים משדרגות משמעותית את הכוח של בעיות קיצון
-- לא דמיינתי אף פעם שאכיר יכולת למצוא מצב אופטימלי (מינימלי/מקסימלי)
כשניתן "לשחק" עם <strong>יותר </strong>ממשתנה
אחד. 
&nbsp;  



בהתחלה אנחנו נתעסק רק עם פונקציות סקלריות $$(f:\mathbb{R}^{n}\rightarrow\mathbb{R})$$:
הרי בשביל לדבר על מקסימום/מינימום אנחנו חייבים שיהיה יחס סדר בטווח
של הפונקציה. בהמשך (בחלק של קיצון תחת אילוצים / כופלי לגרנז') נצטמצם
אפילו עוד יותר, ונדבר רק על פונקציות $$f:\mathbb{R}^{2}\rightarrow\mathbb{R}$$.
זה יהיה בגלל שנעבוד עם שיקולים גאומטריים (כמו שכתבתי, בהחלט ניתן ללמוד
את הנושא לכל $$f:\mathbb{R}^{n}\rightarrow\mathbb{R}$$, אבל אני
עוד לא הצלחתי).
&nbsp;  



בחדו"א 1 לא הייתה לנו איזשהי נוסחה
למציאת נקודות קיצון, אלא שיטה שהניבה כמה נקודות "חשודות",
שאותן היינו צריכים לבדוק אחת אחת. הסיבה הייתה שלא גילינו תנאי <strong>מספיק</strong>
לכך שנקודה תהיה נקודת קיצון, אלא רק תנאי <strong>הכרחי</strong> -- לא מצאנו
משוואה ש<strong>רק</strong> נקודות קיצון מקיימות, אבל כן מצאנו משוואה שהן
בהכרח מקיימות $$(f'(x)=0)$$. מכאן עולה המסקנה שאם נקודה לא מקיימת
את המשוואה, אז אין סיכוי שהיא נקודת קיצון, ולכן החשודות הן רק אלו
שכן מקיימות את המשוואה. העקרון הזה ילווה אותנו כאן ב--2
שיטות שונות.

<br>
<h2>בהתחלה זה די דומה</h2>

נגדיר נקודה $$a$$ בתור <strong>מקסימום מקומי </strong>אם קיימת סביבה של
$$a$$ בה: $$\forall x\in U_{a}:f(x)\leq f(a)$$ (אותו דבר למינימום).
נגדיר נקודה $$a$$ בתור <strong>נקודה קריטית</strong> אם מתקיים $$Df(a)=0$$
(או ש-$$f$$ אינה גזירה ב-$$a$$). וכמובן, עכשיו נוכיח שכל נקודת
מקסימום היא נקודה קריטית:


תהי $$a$$ נקודת מקסימום. כדי להראות שמתקיים $$Df(a)=0$$ אנחנו
נראה שלכל וקטור $$u$$ מתקיים $$Df(a)\cdot u=0$$. לכל $$u$$
נגדיר פונקציה $$g(h)=f(a+hu)$$ (שימו לב -- זו פונקציה במשתנה יחיד),
ומהגדרת נגזרת מכוונת ונקבל:

$$
(1)\,\,Df(a)\cdot u=f_{u}(a)=\underset{h\rightarrow0}{lim}\frac{f(a+hu)-f(a)}{h}=\underset{h\rightarrow0}{lim}\frac{g(h)+g(0)}{h}=g'(0)
$$

מכך ש-$$a$$ נקודת מקסימום, קיימת סביבה של $$a$$ בה כל נקודה
מקיימת $$f(x)\leq f(a)$$. בפרט, הנקודות בסביבה הזו שניתנות להצגה
ע"י $$a+hu$$ מקיימות $$f(a+hu)\leq f(a)$$,
כלומר $$g(h)\leq g(0)$$. זה אומר ש--0 היא נקודת
מקסימום של $$g$$, ולכן ממשפט פרמה מתקיים $$g'(0)=0$$. אם נציב
זאת ב-(1) נקבל $$Df(a)\cdot u=0$$, ובגלל שזה עבור
$$u$$ שרירותי נקבל $$Df(a)=0$$ כנדרש.


אז השלב הראשון כבר ברור לנו -- הנקודות החשובות הן אלו שהנגזרת מתאפסת
בהן. השוואת הנגזרת לאפס משמעותה השוואת כל רכיב בגרדיאנט ל-0,
ולכן נקבל מערכת משוואות שתוביל אותנו לפתרון.
&nbsp;  

&nbsp;  
סוג אחד של נקודות שבהן הנגזרת מתאפסת <strong>ואינן</strong> נקודת קיצון נקרא<strong>
נקודת אוכף</strong>, בגלל האופן שבו הן נראות בפונקציות מ-$$\mathbb{R}^{2}$$ל-$$\mathbb{R}$$.
אם נצא מהנקודה בכיוונים מסוימים נהיה בעליה, אבל אם נצא ממנה בכיוונים
אחרים נהיה בירידה -- כלומר אין סביבה של הנקודה שבה הכל גבוה/נמוך
יותר. 
&nbsp;  
התמונה הבאה מראה את הפונקציה $$f(x,y)=-xy$$. מתקיים $$\nabla f=(\frac{\vartheta f}{\vartheta x},\frac{\vartheta f}{\vartheta y})=(-y,-x)$$,
אז קל להסיק שהנגזרת מתאפסת רק עבור הקלט $$x=y=0$$, כלומר רק בנקודה
$$(0,0,0)$$. עוד לא דיברנו על שיטות להבדיל בין נקודות קיצון לבין
נקודות אוכף, אבל מחקירה של ערכי הפונקציה בסביבה של ראשית הצירים אפשר
להגיע למסקנה שזו נקודת אוכף. <img src='/blog/images/min_max_1.png'>

([https://www.geogebra.org/3d/e6yrf62e](https://www.geogebra.org/3d/e6yrf62e){:target="_blank"})
&nbsp;  

&nbsp;  
ומה הדרך להבדיל בין נקודות קיצון לשאר? בשביל להבין אותה צריך להבין
"תבניות בי-לינאריות" (מושג מהעולם
של אלגברה לינארית שאני לא שולט בו), אז לא אכתוב על הנושא. אני כן אגיד
"על רגל אחת" שמסתכלים על כל הנגזרות
החלקיות מסדר 2 של $$f$$, דבר שאינטואיטיבית אמור
להסתדר לנו.

<br>
<h2>ובהמשך זה די שונה</h2>

אני אתחיל במשפט שיישמע מוזר, ואז אני אסביר: בעולם של פונקציות בכמה
משתנים, ניתן לנסח ולפתור בעיות אופטימיזציה גם בפונקציות ללא נקודות
קיצון.
&nbsp;  
לפעמים, אם ניקח פונקציה ונצמצם את תחום ההגדרה שלה לתת-קבוצה כלשהי,
נגלה שבתחום המצומצם הפונקציה כן מקבלת מקסימום ומינימום. למה שנעשה
דבר כזה בכלל? כי לפעמים נרצה לעשות אופטימיזציה לתהליך שמתואר ע"י
פונקציה כלשהי, אבל העולם האמיתי של הבעיה יגביל אותנו, ולא נוכל לאפשר
<strong>כל</strong> קלט אפשרי בתור פתרון. 


לדוגמה, נניח שיש לנו חוט שאנחנו רוצים לחתוך ל-3 חלקים,
ונניח שממש חשוב לנו לשאוף שמכפלת 3 האורכים תהיה גבוהה
ככל האפשר. אפשר לתאר את הגודל שנרצה למקסם בתור פלט הפונקציה $$f(x,y,z)=xyz$$
כאשר $$x,y,z$$ מייצגים את אורכי החלקים (תשתכנעו שאין לפונקציה הזו
נקודת קיצון). אבל אם אורך החוט המקורי הוא רק $$L$$, אז הערכים של
$$x,y,z$$ נהיים מאוד מוגבלים: בהכרח $$x+y+z=L$$, ובנוסף חייב
להתקיים $$0\leq x,y,z\leq L$$. 

תחת ההגבלות האלה אכן קיימת נקודת מקסימום (הדרך שבה אראה זאת <strong>לא</strong>
רלוונטית להמשך, אני מוכיח רק עבור מי שלא רוצה "להאמין"
לי): אפשר לשנות את פונקציית המטרה להיות $$f(x,y)=xy(L-x-y)$$, למצוא
את הנקודות שבהן הנגזרת מתאפסת, ולראות שהנקודה היחידה שבה באמת $$0\leq x,y,(L-x-y)\leq L$$
היא $$(\frac{1}{3}L,\frac{1}{3}L)$$. מכך נלמד <strong>שתחת האילוצים</strong>
האלו, הנקודה בעלת הערך הכי גבוה ב-$$f$$ המקורית היא הנקודה $$(\frac{1}{3}L,\frac{1}{3}L,\frac{1}{3}L)$$
(כי הרי האורך $$L-x-y$$ יהיה $$\frac{1}{3}L$$).


שימו לב שב--$$f$$ המקורית (בעלת תחום ב-$$\mathbb{R}^{3}$$)
הנגזרת לא התאפסה בנקודה הזו -- אז אנחנו צריכים למצוא דרך אחרת לפתור
מקרים כאלו.

<br>
<h2>בעיות קיצון תחת אילוצים</h2>

נתעמק רגע במושג "אילוץ" ונגדיר
אותו כמו שצריך. בתכלס, אילוץ הוא תחום ההגדרה בו הבעיה חיה -- הוא
מגדיר מהי קבוצת הנקודות שיעניינו אותנו, ולצורך הבעיה אפשר להתעלם משאר
התחום. אם יהיו לנו כמה אילוצים, ניתן יהיה לחשוב על תחום ההגדרה בתור
חיתוך הקבוצות שכל אילוץ מגדיר. 
&nbsp;  
את האילוץ מהדוגמה ניתן לייצג בתור הקבוצה $$\left\{ (x,y,z)\,:\,x+y+z=L\right\} $$.
ניתן גם להציג אותו באופן הבא: נגדיר פונקציה $$g(x,y,z)=x+y+z$$
ונגדיר את האילוץ בתור $$g(x,y,z)=L$$. אציין כאן (שוב כנקודה רלוונטית
להמשך) שההצגה הזו נותנת עוד נקודת מבט על האילוץ -- כאן הוא מוגדר
בתור קו-גובה/משטח-גובה של הפונקציה $$g$$.
&nbsp;  

&nbsp;  
נעבור לדוגמה אחרת שאיתה נמשיך הלאה: נחפש נקודות מקסימום של הפונקציה
$$f(x,y)=-2xy+2$$ תחת האילוץ $$x^{2}+y^{2}=1$$. נגדיר $$g(x,y)=x^{2}+y^{2}$$
ונייצג את האילוץ ע"י $$g(x,y)=1$$.


<img src='/blog/images/min_max_2.png'>(המשטח הכתום
הוא $$f$$, המעגל במישור/בתחום ההגדרה הוא האילוץ, והעקום השחור הוא
הנקודות ב-$$f$$ שמקיימות את האילוץ. כל התמונות הבאות יהיו צילומי
מסך מהקישור הבא, שבו אפשר לראות הכל מכל הזוויות. בפרט, בשביל להזיז
את קווי-הגובה של $$f$$ צריך לשחק עם הערכים של המשתנה $$z_{0}$$:
[https://www.geogebra.org/3d/dbyguca6](https://www.geogebra.org/3d/dbyguca6){:target="_blank"})
&nbsp;  

&nbsp;  
נתחיל לבנות את השיטה החדשה, קודם כל מהפן האינטואיטיבי ולאחר מכן באופן
פורמלי. 


כזכור, אנחנו רוצים למצוא נקודות חשודות מהתחום -- נקודות ששייכות לקבוצת
האילוצים, שבסביבה שלהן הן מקבלות את הערך הגבוה ביותר (כאן סביבה תחיה
רק "בתוך" האילוצים). מהתמונה, נראה
שקיימים הרבה "זוגות" של נקודות
שחורות שמקבלות אותו ערך ב-$$f$$, כלומר אותו גובה בגרף. ואכן, ישנם
הרבה ערכים שעבורם אם נעביר קו-גובה של $$f$$, נחתוך את העקום ב-2
נקודות. 


מה יקרה אם נסרטט קו-גובה כלשהו של $$f$$, ולאט לאט נגדיל את הגובה?
בשלב מסוים נגיע לנקודה שקו-הגובה יהיה <strong>משיק לאילוץ</strong> -- ואם
נרים אותו אפילו טיפה כבר לא יהיה חיתוך בכלל. במילים אחרות, נגיע לגובה
שבו נמצאת רק נקודה יחידה (כלומר, יש ל-$$f$$ נקודה יחידה בגובה זה
בסביבה הזו), ובכל גובה גדול יותר לא תהיה אף נקודה (כלומר $$f$$
לא מקבלת ערך גבוה יותר בסביבה הזו). נשמע כמו נקודת קיצון לא? 


<img src='/blog/images/min_max_3.png'><img src='/blog/images/min_max_4.png'>(התמונה
התחתונה נועדה רק להמחיש את הרעיון מזווית אחרת. קווי-הגובה והאילוץ
אמורים לחיות בתוך תחום ההגדרה (כלומר, בפונקציות $$\mathbb{R}^{2}\rightarrow\mathbb{R}$$
הם יהיו במישור $$xy$$), כמו בתמונה העליונה)
&nbsp;  

&nbsp;  
נמשיך עם הכיוון הזה באופן יותר פורמלי. מעכשיו $$f(x,y)$$ תהיה פונקציה
כלשהי ו--$$g(x,y)=c$$ יהיה אילוץ כלשהו. ניזכר שאנחנו עובדים בשיטה
של "תנאי מספיק" ולא תנאי הכרחי,
לכן אנחנו מתחילים מהשאלה "אם נקודה כלשהי $$a$$
היא קיצון, מה היינו יכולים להסיק עליה?". 


מתוך ההבנה ש--$$a$$ תהיה הגבוהה ביותר בסביבה שלה (ותהיה יחידה
כזאת בסביבה שלה), הבנו שב--$$a$$ יש לקו-הגובה ולאילוץ משיק משותף.
ראינו שהאילוץ מוגדר ע"י המשטח $$g(x,y)=c$$, ואנחנו
יודעים שקו הגובה מוגדר ע"י $$f(x,y)=h$$.


בפסקה הזו מגיעה <strong>ה-הבחנה</strong> של הפוסט. למדנו בעבר שעבור משטח כלשהו
$$S(x,y)=c$$, הוקטור $$\nabla S(a)$$ ניצב לוקטור שמשיק למשטח
ב--$$a$$ (בתנאי ש--$$S$$ גזירה ב--$$a$$ וגם $$\nabla S(a)\neq0$$).
אם לשני המשטחים $$f(x,y)=h$$,$$g(x,y)=c$$ יש משיק משותף ב--$$a$$,
ואם הגרדיאנטים $$\nabla f(a),\nabla g(a)$$ ניצבים למשיק המשותף
הזה, אז הגרדיאנטים בכיוונים זהים/מנוגדים, ומכך קיים $$\lambda\neq0$$
כך ש--$$\nabla f(a)=\lambda\nabla g(a)$$! 


זו פיסת המידע המשמעותית שחיפשנו, התכונה שכל נקודת קיצון בהכרח תקיים.


המשוואה $$\nabla f(a)=\lambda\nabla g(a)$$ מכילה בתוכה 2
משוואות ב-3 נעלמים -- אם נשווה כל רכיב בנפרד נקבל:


$$
f_{x}(a)=\lambda g_{x}(a)
$$



$$
f_{y}(a)=\lambda g_{x}(a)
$$



נעלם אחד הוא $$\lambda$$ ושני הנעלמים האחרים הם 2
הקואורדינטות של $$a$$. <strong>אבל</strong>, עכשיו נשים לב שיש בידינו גם
משוואה שלישית -- הנקודה $$a$$ חייבת לקיים את האילוץ שלנו, לכן
$$g(a)=c$$. כך אנחנו מקבלים מערכת של 3 משוואות ב-3
נעלמים, בה כל פתרון $$(\lambda,x_{a},y_{a})$$ מלמד אותנו על נקודה
חשודה כקיצון תחת האילוץ.
&nbsp;  

&nbsp;  
נחזור לדוגמה שלנו ונפעיל עליה את השיטה ($$f(x,y)=-2xy+2\,,\,g(x,y)=x^{2}+y^{2}$$
והאילוץ $$g(x,y)=1$$): הנגזרות החלקיות של $$f$$ ושל $$g$$
הן:

$$
f_{x}=-2y\,,\,f_{y}=-2x\,,\,g_{x}=2x\,,\,g_{y}=2y
$$

לכן מערכת המשוואות שעלינו לפתור היא:

$$
-2y_{a}=\lambda2x_{a}
$$



$$
-2x_{a}=\lambda2y_{a}
$$



$$
x_{a}^{2}+y_{a}^{2}=1
$$



לצערינו לא כל המשוואות לינאריות (באילוץ יש נעלמים בריבוע), אז אי אפשר
לפתור ע"י דירוג, אבל קצת עבודה מביאה 4
פתרונות: $$(\pm\sqrt{\frac{1}{2}},\pm\sqrt{\frac{1}{2}})$$.
